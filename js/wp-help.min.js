(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.ScoutDocs = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

/*
 * decaffeinate suggestions:
 * DS102: Remove unnecessary code created because of implicit returns
 * DS207: Consider shorter variations of null checks
 * Full docs: https://github.com/decaffeinate/decaffeinate/blob/master/docs/suggestions.md
 */
jQuery(function ($) {
	var whens = [];
	var deferred = undefined;
	var load = {
		start: function start(sensitivity) {
			// Create the timer deferred: the read/write timer state.
			if (sensitivity === null) {
				sensitivity = 0;
			}
			var timer = $.Deferred();

			// Show the spinner.
			data.loading.show();

			// Start the timer.
			setTimeout(function () {
				return timer.resolve();
			}, sensitivity);

			// Return the promise: the read-only timer state.
			return timer.promise();
		},
		stop: function stop() {
			deferred && deferred.reject();

			deferred = null;
			whens = [];
			data.loading.hide();
		},


		/*
    Show the loading spinner until all the promises succeed.
    Optionally show the spinner for a minimum amount of time.
     until( [sensitivity], promises* );
    @param  {number} sensitivity The number of milliseconds to show the spinner, at minimum.
    @param  {object} promises*   Any number of jQuery promises.
    @return {object}             A jQuery promise representing the state of all input promises.
    */
		until: function until(sensitivity) {
			if (sensitivity == null) {
				sensitivity = 0;
			}

			deferred = deferred || $.Deferred().always(api.load.stop);
			var index = whens.push(false) - 1;

			// Add the start promise onto the the stack.

			for (var _len = arguments.length, promises = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
				promises[_key - 1] = arguments[_key];
			}

			promises.push(api.load.start(sensitivity));

			// When all the promises are complete (including the timer), hide the timer.
			// $.when returns a promise object.
			$.when.apply($, promises).always(function () {
				whens[index] = true;

				// Are there any pending requests?
				if (-1 === $.inArray(false, whens)) {
					return deferred.resolve();
				}
			});

			return deferred.promise();
		}
	};

	var api = {
		p: function p(i) {
			return $('#cws-wp-help-' + i);
		},


		load: load,
		bindH2Updates: function bindH2Updates() {
			// Refresh this in case we just moved the menu
			data.menu = $('#adminmenu a.current .wp-menu-name'); // WordPress 3.5+
			// WordPress 3.4.x and lower
			if (!data.menu.length) {
				data.menu = $('#adminmenu a.current');
			}
			data.menu.text(data.h2.edit.input.val());

			// Send h2 updates to the menu item as we type
			data.h2.edit.input.bind('keyup', function () {
				return data.menu.text($(this).val());
			});
		},
		sortable: function sortable() {
			$(this).sortable({
				opacity: 0.8,
				placeholder: 'cws-wp-help-placeholder',
				axis: 'y',
				cursor: 'move',
				cursorAt: {
					left: 0,
					top: 0
				},

				distance: 10,
				delay: 50,
				handle: '.sort-handle',
				items: '> li.cws-wp-help-local, > div#cws-wp-help-remote-docs-block',
				start: function start(e, ui) {
					var item = $(ui.item);
					var placeholder = $('.cws-wp-help-placeholder');
					var offset = undefined;
					if (item.attr('id') === 'cws-wp-help-remote-docs-block') {
						offset = 4;
					} else {
						offset = -2;
					}
					placeholder.height(item.height() + offset);
				},
				update: function update(e, ui) {
					var request = $.post(ajaxurl, {
						action: 'cws_wp_help_reorder',
						_ajax_nonce: data.ul.data('nonce'),
						order: $(this).sortable('toArray')
					});
					api.load.until(200, request);
				}
			});

			return $(this).find('> li:not(.cws-wp-help-is-slurped) > ul > li:nth-child(2)').parent('ul').each(api.sortable);
		},
		sortableInit: function sortableInit() {
			// Wrap remote docs
			data.ul.find('> #cws-wp-help-remote-docs-block > li').unwrap();
			data.ul.find('> li.cws-wp-help-is-slurped:first').before('<div id="cws-wp-help-remote-docs-block"></div>');
			data.ul.find('> li.cws-wp-help-is-slurped').detach().appendTo('#cws-wp-help-remote-docs-block');

			// Sortable
			data.ulSortable.each(api.sortable);
		},
		init: function init() {
			var _this = this;

			// Sortable
			api.sortableInit();

			// Add IDs to the list
			data.ul.find('li.page_item').each(function () {
				$(this).attr('id', 'page-' + $(this).attr('class').match(/page-item-([0-9]+)/)[1]);
			});

			// Clicking the source API URI.
			data.apiURL.click(function () {
				return _this.select();
			});

			// Clicking the "Save Changes" button.
			data.saveButton.click(function () {
				return api.saveSettings();
			});

			// Clicking the "Cancel" button (settings)
			data.cancelLink.click(function (e) {
				e.preventDefault();
				api.restoreSettings();
				api.hideSettings();
			});

			// Clicking the "Settings" button
			data.settingsButton.click(function (e) {
				e.preventDefault();
				api.revealSettings(true);
			}); // true = autofocus on the h2 with no highlighting

			// Doubleclick the h2
			data.h2.display.text.dblclick(function () {
				api.revealSettings();
				data.h2.edit.input.focus().select();
			});

			// Doubleclick the h3
			data.h3.display.text.dblclick(function () {
				api.revealSettings();
				data.h3.edit.input.focus().select();
			});

			// Monitor for "return" presses in our text inputs
			data.returnMonitor.bind('keydown', function (e) {
				if (13 === e.which) {
					$(this).blur();
					api.saveSettings();
				}
			});

			api.bindH2Updates();

			// Preview menu placement "live"
			data.menuLocation.change(function () {
				var newLocation = String(window.location);
				if (data.menuLocation.val().indexOf('submenu') === -1) {
					newLocation = newLocation.replace('/index.php', '/admin.php');
				} else {
					newLocation = newLocation.replace('/admin.php', '/index.php');
				}
				var newLocationPreview = String(newLocation) + '&wp-help-preview-menu-location=' + data.menuLocation.val();
				var commonScript = String(newLocation).replace(/\/wp-admin\/.*$/, '/wp-admin/js/common.js');
				$('#adminmenu').load(newLocationPreview + ' #adminmenu', function () {
					if (window.history.replaceState) {
						window.history.replaceState(null, null, newLocation);
					}
					$.getScript(commonScript); // Makes the menu work again
					api.bindH2Updates();
				});
			});
		},
		// Makes live H2 previewing work again

		fadeOutIn: function fadeOutIn(first, second) {
			return first.fadeOut(150, function () {
				return second.fadeIn(150);
			});
		},
		hideShow: function hideShow(hide, show) {
			hide.hide();
			return show.show();
		},
		revealSettings: function revealSettings(autofocus) {
			var _arr = [data.h2, data.h3];

			for (var _i = 0; _i < _arr.length; _i++) {
				var item = _arr[_i];
				api.hideShow(item.display.wrap, item.edit.wrap);
			}

			data.actions.fadeTo(200, 0.3);
			data.ul.fadeTo(200, 0.3);
			api.fadeOutIn(data.doc, data.settings);
			if (autofocus) {
				return data.h2.edit.input.focus().select();
				/*
        ((h2) ->
          h2.focus().select()
        ) data.h2.edit.input
        */
			}
		},
		restoreSettings: function restoreSettings() {
			return $('input, select', data.settings).each(function () {
				var i = $(this);
				if (i.data('original-value')) {
					return i.val(i.data('original-value')).change();
				}
			});
		},
		saveSettings: function saveSettings() {
			api.clearError();
			$([data.h2, data.h3]).each(function () {
				return this.display.text.text(this.edit.input.val());
			});

			var request = $.post(ajaxurl, {
				action: 'cws_wp_help_settings',
				_ajax_nonce: $('#_cws_wp_help_nonce').val(),
				h2: data.h2.edit.input.val(),
				h3: data.h3.edit.input.val(),
				menu_location: data.menuLocation.val(),
				slurp_url: data.slurp.val()
			});
			request.success(function (result) {
				result = $.parseJSON(result);
				data.slurp.val(result.slurp_url);
				if (result.error) {
					api.error(result.error);
					data.slurp.focus();
				} else {
					api.hideSettings();
				}
				if (result.topics) {
					api.p('nodocs').remove();
					data.ul.html(result.topics);
					return api.sortableInit();
				}
			});
			return api.load.until(200, request);
		},
		hideSettings: function hideSettings() {
			var _arr2 = [data.h2, data.h3];

			for (var _i2 = 0; _i2 < _arr2.length; _i2++) {
				var item = _arr2[_i2];
				api.hideShow(item.edit.wrap, item.display.wrap);
			}
			data.actions.fadeTo(200, 1);
			data.ul.fadeTo(200, 1);
			return api.fadeOutIn(data.settings, data.doc);
		},
		clearError: function clearError() {
			return data.slurpError.html('').hide();
		},
		error: function error(msg) {
			return data.slurpError.html('<p>' + msg + '</p>').fadeIn(150);
		}
	};

	var data = {
		menu: function menu() {
			return $('#adminmenu a.current');
		},

		h2: {
			edit: {
				input: api.p('h2-label'),
				wrap: api.p('h2-label-wrap')
			},
			display: {
				text: $('.wrap h1:first'),
				wrap: $('.wrap h1:first')
			}
		},
		h3: {
			edit: {
				input: api.p('listing-label'),
				wrap: api.p('listing-labels')
			},
			display: {
				text: api.p('listing h3'),
				wrap: api.p('listing h3')
			}
		},
		settingsButton: api.p('settings-on'),
		doc: api.p('document'),
		ul: api.p('listing-wrap > ul'),
		ulSortable: api.p('listing-wrap > ul.can-sort'),
		actions: api.p('actions'),
		settings: api.p('settings'),
		listing: api.p('listing'),
		apiURL: api.p('api-url'),
		slurp: api.p('slurp-url'),
		slurpError: api.p('slurp-error'),
		saveButton: api.p('settings-save'),
		cancelLink: api.p('settings-cancel'),
		menuLocation: api.p('menu-location'),
		loading: api.p('loading'),
		returnMonitor: $('.wrap input[type="text"]')
	};

	// Bootstrap everything
	return api.init();
});

},{}]},{},[1])(1)
});

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy93cC1oZWxwLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUE7Ozs7OztBQU1BLE9BQU8sYUFBSztBQUNYLEtBQUksUUFBUSxFQUFaO0FBQ0EsS0FBSSxXQUFXLFNBQWY7QUFDQSxLQUFJLE9BQU87QUFDVixPQURVLGlCQUNKLFdBREksRUFDUztBQUNsQjtBQUNBLE9BQUksZ0JBQWdCLElBQXBCLEVBQTBCO0FBQ3pCLGtCQUFjLENBQWQ7QUFDQTtBQUNELE9BQU0sUUFBUSxFQUFFLFFBQUYsRUFBZDs7QUFFQTtBQUNBLFFBQUssT0FBTCxDQUFhLElBQWI7O0FBRUE7QUFDQSxjQUFXO0FBQUEsV0FBTSxNQUFNLE9BQU4sRUFBTjtBQUFBLElBQVgsRUFBa0MsV0FBbEM7O0FBRUE7QUFDQSxVQUFPLE1BQU0sT0FBTixFQUFQO0FBQ0EsR0FoQlM7QUFrQlYsTUFsQlUsa0JBa0JIO0FBQ04sZUFBWSxTQUFTLE1BQVQsRUFBWjs7QUFFQSxjQUFXLElBQVg7QUFDQSxXQUFRLEVBQVI7QUFDQSxRQUFLLE9BQUwsQ0FBYSxJQUFiO0FBQ0EsR0F4QlM7OztBQTBCVjs7Ozs7Ozs7QUFTQSxPQW5DVSxpQkFtQ0osV0FuQ0ksRUFtQ3NCO0FBQy9CLE9BQUksZUFBZSxJQUFuQixFQUF5QjtBQUN4QixrQkFBYyxDQUFkO0FBQ0E7O0FBRUQsY0FBVyxZQUFZLEVBQUUsUUFBRixHQUFhLE1BQWIsQ0FBb0IsSUFBSSxJQUFKLENBQVMsSUFBN0IsQ0FBdkI7QUFDQSxPQUFNLFFBQVEsTUFBTSxJQUFOLENBQVcsS0FBWCxJQUFvQixDQUFsQzs7QUFFQTs7QUFSK0IscUNBQVYsUUFBVTtBQUFWLFlBQVU7QUFBQTs7QUFTL0IsWUFBUyxJQUFULENBQWMsSUFBSSxJQUFKLENBQVMsS0FBVCxDQUFlLFdBQWYsQ0FBZDs7QUFFQTtBQUNBO0FBQ0EsS0FBRSxJQUFGLENBQU8sS0FBUCxDQUFh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QU07QUFDTCxXQUFPLElBQUksQ0FBSixDQUFNLGVBQU4sQ0FERjtBQUVMLFVBQU0sSUFBSSxDQUFKLENBQU0sZ0JBQU47QUFGRCxJQURIO0FBS0gsWUFBUztBQUNSLFVBQU0sSUFBSSxDQUFKLENBQU0sWUFBTixDQURFO0FBRVIsVUFBTSxJQUFJLENBQUosQ0FBTSxZQUFOO0FBRkU7QUFMTixHQWRNO0FBd0JWLGtCQUFnQixJQUFJLENBQUosQ0FBTSxhQUFOLENBeEJOO0FBeUJWLE9BQUssSUFBSSxDQUFKLENBQU0sVUFBTixDQXpCSztBQTBCVixNQUFJLElBQUksQ0FBSixDQUFNLG1CQUFOLENBMUJNO0FBMkJWLGNBQVksSUFBSSxDQUFKLENBQU0sNEJBQU4sQ0EzQkY7QUE0QlYsV0FBUyxJQUFJLENBQUosQ0FBTSxTQUFOLENBNUJDO0FBNkJWLFlBQVUsSUFBSSxDQUFKLENBQU0sVUFBTixDQTdCQTtBQThCVixXQUFTLElBQUksQ0FBSixDQUFNLFNBQU4sQ0E5QkM7QUErQlYsVUFBUSxJQUFJLENBQUosQ0FBTSxTQUFOLENBL0JFO0FBZ0NWLFNBQU8sSUFBSSxDQUFKLENBQU0sV0FBTixDQWhDRztBQWlDVixjQUFZLElBQUksQ0FBSixDQUFNLGFBQU4sQ0FqQ0Y7QUFrQ1YsY0FBWSxJQUFJLENBQUosQ0FBTSxlQUFOLENBbENGO0FBbUNWLGNBQVksSUFBSSxDQUFKLENBQU0saUJBQU4sQ0FuQ0Y7QUFvQ1YsZ0JBQWMsSUFBSSxDQUFKLENBQU0sZUFBTixDQXBDSjtBQXFDVixXQUFTLElBQUksQ0FBSixDQUFNLFNBQU4sQ0FyQ0M7QUFzQ1YsaUJBQWUsRUFBRSwwQkFBRjtBQXRDTCxFQUFYOztBQXlDQTtBQUNBLFFBQU8sSUFBSSxJQUFKLEVBQVA7QUFDQSxDQWxXRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8qXG4gKiBkZWNhZmZlaW5hdGUgc3VnZ2VzdGlvbnM6XG4gKiBEUzEwMjogUmVtb3ZlIHVubmVjZXNzYXJ5IGNvZGUgY3JlYXRlZCBiZWNhdXNlIG9mIGltcGxpY2l0IHJldHVybnNcbiAqIERTMjA3OiBDb25zaWRlciBzaG9ydGVyIHZhcmlhdGlvbnMgb2YgbnVsbCBjaGVja3NcbiAqIEZ1bGwgZG9jczogaHR0cHM6Ly9naXRodWIuY29tL2RlY2FmZmVpbmF0ZS9kZWNhZmZlaW5hdGUvYmxvYi9tYXN0ZXIvZG9jcy9zdWdnZXN0aW9ucy5tZFxuICovXG5qUXVlcnkoJCA9PiB7XG5cdGxldCB3aGVucyA9IFtdO1xuXHRsZXQgZGVmZXJyZWQgPSB1bmRlZmluZWQ7XG5cdGxldCBsb2FkID0ge1xuXHRcdHN0YXJ0KHNlbnNpdGl2aXR5KSB7XG5cdFx0XHQvLyBDcmVhdGUgdGhlIHRpbWVyIGRlZmVycmVkOiB0aGUgcmVhZC93cml0ZSB0aW1lciBzdGF0ZS5cblx0XHRcdGlmIChzZW5zaXRpdml0eSA9PT0gbnVsbCkge1xuXHRcdFx0XHRzZW5zaXRpdml0eSA9IDA7XG5cdFx0XHR9XG5cdFx0XHRjb25zdCB0aW1lciA9ICQuRGVmZXJyZWQoKTtcblxuXHRcdFx0Ly8gU2hvdyB0aGUgc3Bpbm5lci5cblx0XHRcdGRhdGEubG9hZGluZy5zaG93KCk7XG5cblx0XHRcdC8vIFN0YXJ0IHRoZSB0aW1lci5cblx0XHRcdHNldFRpbWVvdXQoKCkgPT4gdGltZXIucmVzb2x2ZSgpLCBzZW5zaXRpdml0eSk7XG5cblx0XHRcdC8vIFJldHVybiB0aGUgcHJvbWlzZTogdGhlIHJlYWQtb25seSB0aW1lciBzdGF0ZS5cblx0XHRcdHJldHVybiB0aW1lci5wcm9taXNlKCk7XG5cdFx0fSxcblxuXHRcdHN0b3AoKSB7XG5cdFx0XHRkZWZlcnJlZCAmJiBkZWZlcnJlZC5yZWplY3QoKTtcblxuXHRcdFx0ZGVmZXJyZWQgPSBudWxsO1xuXHRcdFx0d2hlbnMgPSBbXTtcblx0XHRcdGRhdGEubG9hZGluZy5oaWRlKCk7XG5cdFx0fSxcblxuXHRcdC8qXG4gICAgU2hvdyB0aGUgbG9hZGluZyBzcGlubmVyIHVudGlsIGFsbCB0aGUgcHJvbWlzZXMgc3VjY2VlZC5cbiAgICBPcHRpb25hbGx5IHNob3cgdGhlIHNwaW5uZXIgZm9yIGEgbWluaW11bSBhbW91bnQgb2YgdGltZS5cblxuICAgIHVudGlsKCBbc2Vuc2l0aXZpdHldLCBwcm9taXNlcyogKTtcbiAgICBAcGFyYW0gIHtudW1iZXJ9IHNlbnNpdGl2aXR5IFRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIHNob3cgdGhlIHNwaW5uZXIsIGF0IG1pbmltdW0uXG4gICAgQHBhcmFtICB7b2JqZWN0fSBwcm9taXNlcyogICBBbnkgbnVtYmVyIG9mIGpRdWVyeSBwcm9taXNlcy5cbiAgICBAcmV0dXJuIHtvYmplY3R9ICAgICAgICAgICAgIEEgalF1ZXJ5IHByb21pc2UgcmVwcmVzZW50aW5nIHRoZSBzdGF0ZSBvZiBhbGwgaW5wdXQgcHJvbWlzZXMuXG4gICAgKi9cblx0XHR1bnRpbChzZW5zaXRpdml0eSwgLi4ucHJvbWlzZXMpIHtcblx0XHRcdGlmIChzZW5zaXRpdml0eSA9PSBudWxsKSB7XG5cdFx0XHRcdHNlbnNpdGl2aXR5ID0gMDtcblx0XHRcdH1cblxuXHRcdFx0ZGVmZXJyZWQgPSBkZWZlcnJlZCB8fCAkLkRlZmVycmVkKCkuYWx3YXlzKGFwaS5sb2FkLnN0b3ApO1xuXHRcdFx0Y29uc3QgaW5kZXggPSB3aGVucy5wdXNoKGZhbHNlKSAtIDE7XG5cblx0XHRcdC8vIEFkZCB0aGUgc3RhcnQgcHJvbWlzZSBvbnRvIHRoZSB0aGUgc3RhY2suXG5cdFx0XHRwcm9taXNlcy5wdXNoKGFwaS5sb2FkLnN0YXJ0KHNlbnNpdGl2aXR5KSk7XG5cblx0XHRcdC8vIFdoZW4gYWxsIHRoZSBwcm9taXNlcyBhcmUgY29tcGxldGUgKGluY2x1ZGluZyB0aGUgdGltZXIpLCBoaWRlIHRoZSB0aW1lci5cblx0XHRcdC8vICQud2hlbiByZXR1cm5zIGEgcHJvbWlzZSBvYmplY3QuXG5cdFx0XHQkLndoZW4uYXBwbHkoJCwgcHJvbWlzZXMpLmFsd2F5cyhmdW5jdGlvbigpIHtcblx0XHRcdFx0d2hlbnNbaW5kZXhdID0gdHJ1ZTtcblxuXHRcdFx0XHQvLyBBcmUgdGhlcmUgYW55IHBlbmRpbmcgcmVxdWVzdHM/XG5cdFx0XHRcdGlmICgtMSA9PT0gJC5pbkFycmF5KGZhbHNlLCB3aGVucykpIHtcblx0XHRcdFx0XHRyZXR1cm4gZGVmZXJyZWQucmVzb2x2ZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0cmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcblx0XHR9LFxuXHR9O1xuXG5cdHZhciBhcGkgPSB7XG5cdFx0cChpKSB7XG5cdFx0XHRyZXR1cm4gJChgI2N3cy13cC1oZWxwLSR7aX1gKTtcblx0XHR9LFxuXG5cdFx0bG9hZDogbG9hZCxcblx0XHRiaW5kSDJVcGRhdGVzKCkge1xuXHRcdFx0Ly8gUmVmcmVzaCB0aGlzIGluIGNhc2Ugd2UganVzdCBtb3ZlZCB0aGUgbWVudVxuXHRcdFx0ZGF0YS5tZW51ID0gJCgnI2FkbWlubWVudSBhLmN1cnJlbnQgLndwLW1lbnUtbmFtZScpOyAvLyBXb3JkUHJlc3MgMy41K1xuXHRcdFx0Ly8gV29yZFByZXNzIDMuNC54IGFuZCBsb3dlclxuXHRcdFx0aWYgKCFkYXRhLm1lbnUubGVuZ3RoKSB7XG5cdFx0XHRcdGRhdGEubWVudSA9ICQoJyNhZG1pbm1lbnUgYS5jdXJyZW50Jyk7XG5cdFx0XHR9XG5cdFx0XHRkYXRhLm1lbnUudGV4dChkYXRhLmgyLmVkaXQuaW5wdXQudmFsKCkpO1xuXG5cdFx0XHQvLyBTZW5kIGgyIHVwZGF0ZXMgdG8gdGhlIG1lbnUgaXRlbSBhcyB3ZSB0eXBlXG5cdFx0XHRkYXRhLmgyLmVkaXQuaW5wdXQuYmluZCgna2V5dXAnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIGRhdGEubWVudS50ZXh0KCQodGhpcykudmFsKCkpO1xuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdHNvcnRhYmxlKCkge1xuXHRcdFx0JCh0aGlzKS5zb3J0YWJsZSh7XG5cdFx0XHRcdG9wYWNpdHk6IDAuOCxcblx0XHRcdFx0cGxhY2Vob2xkZXI6ICdjd3Mtd3AtaGVscC1wbGFjZWhvbGRlcicsXG5cdFx0XHRcdGF4aXM6ICd5Jyxcblx0XHRcdFx0Y3Vyc29yOiAnbW92ZScsXG5cdFx0XHRcdGN1cnNvckF0OiB7XG5cdFx0XHRcdFx0bGVmdDogMCxcblx0XHRcdFx0XHR0b3A6IDAsXG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0ZGlzdGFuY2U6IDEwLFxuXHRcdFx0XHRkZWxheTogNTAsXG5cdFx0XHRcdGhhbmRsZTogJy5zb3J0LWhhbmRsZScsXG5cdFx0XHRcdGl0ZW1zOiAnPiBsaS5jd3Mtd3AtaGVscC1sb2NhbCwgPiBkaXYjY3dzLXdwLWhlbHAtcmVtb3RlLWRvY3MtYmxvY2snLFxuXHRcdFx0XHRzdGFydChlLCB1aSkge1xuXHRcdFx0XHRcdGNvbnN0IGl0ZW0gPSAkKHVpLml0ZW0pO1xuXHRcdFx0XHRcdGNvbnN0IHBsYWNlaG9sZGVyID0gJCgnLmN3cy13cC1oZWxwLXBsYWNlaG9sZGVyJyk7XG5cdFx0XHRcdFx0bGV0IG9mZnNldCA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRpZiAoaXRlbS5hdHRyKCdpZCcpID09PSAnY3dzLXdwLWhlbHAtcmVtb3RlLWRvY3MtYmxvY2snKSB7XG5cdFx0XHRcdFx0XHRvZmZzZXQgPSA0O1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRvZmZzZXQgPSAtMjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cGxhY2Vob2xkZXIuaGVpZ2h0KGl0ZW0uaGVpZ2h0KCkgKyBvZmZzZXQpO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdHVwZGF0ZShlLCB1aSkge1xuXHRcdFx0XHRcdGNvbnN0IHJlcXVlc3QgPSAkLnBvc3QoYWpheHVybCwge1xuXHRcdFx0XHRcdFx0YWN0aW9uOiAnY3dzX3dwX2hlbHBfcmVvcmRlcicsXG5cdFx0XHRcdFx0XHRfYWpheF9ub25jZTogZGF0YS51bC5kYXRhKCdub25jZScpLFxuXHRcdFx0XHRcdFx0b3JkZXI6ICQodGhpcykuc29ydGFibGUoJ3RvQXJyYXknKSxcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRhcGkubG9hZC51bnRpbCgyMDAsIHJlcXVlc3QpO1xuXHRcdFx0XHR9LFxuXHRcdFx0fSk7XG5cblx0XHRcdHJldHVybiAkKHRoaXMpXG5cdFx0XHRcdC5maW5kKCc+IGxpOm5vdCguY3dzLXdwLWhlbHAtaXMtc2x1cnBlZCkgPiB1bCA+IGxpOm50aC1jaGlsZCgyKScpXG5cdFx0XHRcdC5wYXJlbnQoJ3VsJylcblx0XHRcdFx0LmVhY2goYXBpLnNvcnRhYmxlKTtcblx0XHR9LFxuXG5cdFx0c29ydGFibGVJbml0KCkge1xuXHRcdFx0Ly8gV3JhcCByZW1vdGUgZG9jc1xuXHRcdFx0ZGF0YS51bC5maW5kKCc+ICNjd3Mtd3AtaGVscC1yZW1vdGUtZG9jcy1ibG9jayA+IGxpJykudW53cmFwKCk7XG5cdFx0XHRkYXRhLnVsXG5cdFx0XHRcdC5maW5kKCc+IGxpLmN3cy13cC1oZWxwLWlzLXNsdXJwZWQ6Zmlyc3QnKVxuXHRcdFx0XHQuYmVmb3JlKCc8ZGl2IGlkPVwiY3dzLXdwLWhlbHAtcmVtb3RlLWRvY3MtYmxvY2tcIj48L2Rpdj4nKTtcblx0XHRcdGRhdGEudWxcblx0XHRcdFx0LmZpbmQoJz4gbGkuY3dzLXdwLWhlbHAtaXMtc2x1cnBlZCcpXG5cdFx0XHRcdC5kZXRhY2goKVxuXHRcdFx0XHQuYXBwZW5kVG8oJyNjd3Mtd3AtaGVscC1yZW1vdGUtZG9jcy1ibG9jaycpO1xuXG5cdFx0XHQvLyBTb3J0YWJsZVxuXHRcdFx0ZGF0YS51bFNvcnRhYmxlLmVhY2goYXBpLnNvcnRhYmxlKTtcblx0XHR9LFxuXG5cdFx0aW5pdCgpIHtcblx0XHRcdC8vIFNvcnRhYmxlXG5cdFx0XHRhcGkuc29ydGFibGVJbml0KCk7XG5cblx0XHRcdC8vIEFkZCBJRHMgdG8gdGhlIGxpc3Rcblx0XHRcdGRhdGEudWwuZmluZCgnbGkucGFnZV9pdGVtJykuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0JCh0aGlzKS5hdHRyKFxuXHRcdFx0XHRcdCdpZCcsXG5cdFx0XHRcdFx0YHBhZ2UtJHtcblx0XHRcdFx0XHRcdCQodGhpcylcblx0XHRcdFx0XHRcdFx0LmF0dHIoJ2NsYXNzJylcblx0XHRcdFx0XHRcdFx0Lm1hdGNoKC9wYWdlLWl0ZW0tKFswLTldKykvKVsxXVxuXHRcdFx0XHRcdH1gXG5cdFx0XHRcdCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gQ2xpY2tpbmcgdGhlIHNvdXJjZSBBUEkgVVJJLlxuXHRcdFx0ZGF0YS5hcGlVUkwuY2xpY2soKCkgPT4gdGhpcy5zZWxlY3QoKSk7XG5cblx0XHRcdC8vIENsaWNraW5nIHRoZSBcIlNhdmUgQ2hhbmdlc1wiIGJ1dHRvbi5cblx0XHRcdGRhdGEuc2F2ZUJ1dHRvbi5jbGljaygoKSA9PiBhcGkuc2F2ZVNldHRpbmdzKCkpO1xuXG5cdFx0XHQvLyBDbGlja2luZyB0aGUgXCJDYW5jZWxcIiBidXR0b24gKHNldHRpbmdzKVxuXHRcdFx0ZGF0YS5jYW5jZWxMaW5rLmNsaWNrKGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRhcGkucmVzdG9yZVNldHRpbmdzKCk7XG5cdFx0XHRcdGFwaS5oaWRlU2V0dGluZ3MoKTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBDbGlja2luZyB0aGUgXCJTZXR0aW5nc1wiIGJ1dHRvblxuXHRcdFx0ZGF0YS5zZXR0aW5nc0J1dHRvbi5jbGljayhmdW5jdGlvbihlKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0YXBpLnJldmVhbFNldHRpbmdzKHRydWUpO1xuXHRcdFx0fSk7IC8vIHRydWUgPSBhdXRvZm9jdXMgb24gdGhlIGgyIHdpdGggbm8gaGlnaGxpZ2h0aW5nXG5cblx0XHRcdC8vIERvdWJsZWNsaWNrIHRoZSBoMlxuXHRcdFx0ZGF0YS5oMi5kaXNwbGF5LnRleHQuZGJsY2xpY2soZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGFwaS5yZXZlYWxTZXR0aW5ncygpO1xuXHRcdFx0XHRkYXRhLmgyLmVkaXQuaW5wdXQuZm9jdXMoKS5zZWxlY3QoKTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBEb3VibGVjbGljayB0aGUgaDNcblx0XHRcdGRhdGEuaDMuZGlzcGxheS50ZXh0LmRibGNsaWNrKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRhcGkucmV2ZWFsU2V0dGluZ3MoKTtcblx0XHRcdFx0ZGF0YS5oMy5lZGl0LmlucHV0LmZvY3VzKCkuc2VsZWN0KCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gTW9uaXRvciBmb3IgXCJyZXR1cm5cIiBwcmVzc2VzIGluIG91ciB0ZXh0IGlucHV0c1xuXHRcdFx0ZGF0YS5yZXR1cm5Nb25pdG9yLmJpbmQoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdGlmICgxMyA9PT0gZS53aGljaCkge1xuXHRcdFx0XHRcdCQodGhpcykuYmx1cigpO1xuXHRcdFx0XHRcdGFwaS5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdGFwaS5iaW5kSDJVcGRhdGVzKCk7XG5cblx0XHRcdC8vIFByZXZpZXcgbWVudSBwbGFjZW1lbnQgXCJsaXZlXCJcblx0XHRcdGRhdGEubWVudUxvY2F0aW9uLmNoYW5nZShmdW5jdGlvbigpIHtcblx0XHRcdFx0bGV0IG5ld0xvY2F0aW9uID0gU3RyaW5nKHdpbmRvdy5sb2NhdGlvbik7XG5cdFx0XHRcdGlmIChkYXRhLm1lbnVMb2NhdGlvbi52YWwoKS5pbmRleE9mKCdzdWJtZW51JykgPT09IC0xKSB7XG5cdFx0XHRcdFx0bmV3TG9jYXRpb24gPSBuZXdMb2NhdGlvbi5yZXBsYWNlKCcvaW5kZXgucGhwJywgJy9hZG1pbi5waHAnKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRuZXdMb2NhdGlvbiA9IG5ld0xvY2F0aW9uLnJlcGxhY2UoJy9hZG1pbi5waHAnLCAnL2luZGV4LnBocCcpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGNvbnN0IG5ld0xvY2F0aW9uUHJldmlldyA9XG5cdFx0XHRcdFx0YCR7U3RyaW5nKG5ld0xvY2F0aW9uKX0md3AtaGVscC1wcmV2aWV3LW1lbnUtbG9jYXRpb249YCArXG5cdFx0XHRcdFx0ZGF0YS5tZW51TG9jYXRpb24udmFsKCk7XG5cdFx0XHRcdGNvbnN0IGNvbW1vblNjcmlwdCA9IFN0cmluZyhuZXdMb2NhdGlvbikucmVwbGFjZShcblx0XHRcdFx0XHQvXFwvd3AtYWRtaW5cXC8uKiQvLFxuXHRcdFx0XHRcdCcvd3AtYWRtaW4vanMvY29tbW9uLmpzJ1xuXHRcdFx0XHQpO1xuXHRcdFx0XHQkKCcjYWRtaW5tZW51JykubG9hZChuZXdMb2NhdGlvblByZXZpZXcgKyAnICNhZG1pbm1lbnUnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRpZiAod2luZG93Lmhpc3RvcnkucmVwbGFjZVN0YXRlKSB7XG5cdFx0XHRcdFx0XHR3aW5kb3cuaGlzdG9yeS5yZXBsYWNlU3RhdGUobnVsbCwgbnVsbCwgbmV3TG9jYXRpb24pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQkLmdldFNjcmlwdChjb21tb25TY3JpcHQpOyAvLyBNYWtlcyB0aGUgbWVudSB3b3JrIGFnYWluXG5cdFx0XHRcdFx0YXBpLmJpbmRIMlVwZGF0ZXMoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9LCAvLyBNYWtlcyBsaXZlIEgyIHByZXZpZXdpbmcgd29yayBhZ2FpblxuXG5cdFx0ZmFkZU91dEluKGZpcnN0LCBzZWNvbmQpIHtcblx0XHRcdHJldHVybiBmaXJzdC5mYWRlT3V0KDE1MCwgKCkgPT4gc2Vjb25kLmZhZGVJbigxNTApKTtcblx0XHR9LFxuXG5cdFx0aGlkZVNob3coaGlkZSwgc2hvdykge1xuXHRcdFx0aGlkZS5oaWRlKCk7XG5cdFx0XHRyZXR1cm4gc2hvdy5zaG93KCk7XG5cdFx0fSxcblxuXHRcdHJldmVhbFNldHRpbmdzKGF1dG9mb2N1cykge1xuXHRcdFx0Zm9yIChsZXQgaXRlbSBvZiBbZGF0YS5oMiwgZGF0YS5oM10pIHtcblx0XHRcdFx0YXBpLmhpZGVTaG93KGl0ZW0uZGlzcGxheS53cmFwLCBpdGVtLmVkaXQud3JhcCk7XG5cdFx0XHR9XG5cblx0XHRcdGRhdGEuYWN0aW9ucy5mYWRlVG8oMjAwLCAwLjMpO1xuXHRcdFx0ZGF0YS51bC5mYWRlVG8oMjAwLCAwLjMpO1xuXHRcdFx0YXBpLmZhZGVPdXRJbihkYXRhLmRvYywgZGF0YS5zZXR0aW5ncyk7XG5cdFx0XHRpZiAoYXV0b2ZvY3VzKSB7XG5cdFx0XHRcdHJldHVybiBkYXRhLmgyLmVkaXQuaW5wdXQuZm9jdXMoKS5zZWxlY3QoKTtcblx0XHRcdFx0LypcbiAgICAgICAgKChoMikgLT5cbiAgICAgICAgICBoMi5mb2N1cygpLnNlbGVjdCgpXG4gICAgICAgICkgZGF0YS5oMi5lZGl0LmlucHV0XG4gICAgICAgICovXG5cdFx0XHR9XG5cdFx0fSxcblxuXHRcdHJlc3RvcmVTZXR0aW5ncygpIHtcblx0XHRcdHJldHVybiAkKCdpbnB1dCwgc2VsZWN0JywgZGF0YS5zZXR0aW5ncykuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0Y29uc3QgaSA9ICQodGhpcyk7XG5cdFx0XHRcdGlmIChpLmRhdGEoJ29yaWdpbmFsLXZhbHVlJykpIHtcblx0XHRcdFx0XHRyZXR1cm4gaS52YWwoaS5kYXRhKCdvcmlnaW5hbC12YWx1ZScpKS5jaGFuZ2UoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdHNhdmVTZXR0aW5ncygpIHtcblx0XHRcdGFwaS5jbGVhckVycm9yKCk7XG5cdFx0XHQkKFtkYXRhLmgyLCBkYXRhLmgzXSkuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuZGlzcGxheS50ZXh0LnRleHQodGhpcy5lZGl0LmlucHV0LnZhbCgpKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRjb25zdCByZXF1ZXN0ID0gJC5wb3N0KGFqYXh1cmwsIHtcblx0XHRcdFx0YWN0aW9uOiAnY3dzX3dwX2hlbHBfc2V0dGluZ3MnLFxuXHRcdFx0XHRfYWpheF9ub25jZTogJCgnI19jd3Nfd3BfaGVscF9ub25jZScpLnZhbCgpLFxuXHRcdFx0XHRoMjogZGF0YS5oMi5lZGl0LmlucHV0LnZhbCgpLFxuXHRcdFx0XHRoMzogZGF0YS5oMy5lZGl0LmlucHV0LnZhbCgpLFxuXHRcdFx0XHRtZW51X2xvY2F0aW9uOiBkYXRhLm1lbnVMb2NhdGlvbi52YWwoKSxcblx0XHRcdFx0c2x1cnBfdXJsOiBkYXRhLnNsdXJwLnZhbCgpLFxuXHRcdFx0fSk7XG5cdFx0XHRyZXF1ZXN0LnN1Y2Nlc3MoZnVuY3Rpb24ocmVzdWx0KSB7XG5cdFx0XHRcdHJlc3VsdCA9ICQucGFyc2VKU09OKHJlc3VsdCk7XG5cdFx0XHRcdGRhdGEuc2x1cnAudmFsKHJlc3VsdC5zbHVycF91cmwpO1xuXHRcdFx0XHRpZiAocmVzdWx0LmVycm9yKSB7XG5cdFx0XHRcdFx0YXBpLmVycm9yKHJlc3VsdC5lcnJvcik7XG5cdFx0XHRcdFx0ZGF0YS5zbHVycC5mb2N1cygpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGFwaS5oaWRlU2V0dGluZ3MoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAocmVzdWx0LnRvcGljcykge1xuXHRcdFx0XHRcdGFwaS5wKCdub2RvY3MnKS5yZW1vdmUoKTtcblx0XHRcdFx0XHRkYXRhLnVsLmh0bWwocmVzdWx0LnRvcGljcyk7XG5cdFx0XHRcdFx0cmV0dXJuIGFwaS5zb3J0YWJsZUluaXQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gYXBpLmxvYWQudW50aWwoMjAwLCByZXF1ZXN0KTtcblx0XHR9LFxuXG5cdFx0aGlkZVNldHRpbmdzKCkge1xuXHRcdFx0Zm9yIChsZXQgaXRlbSBvZiBbZGF0YS5oMiwgZGF0YS5oM10pIHtcblx0XHRcdFx0YXBpLmhpZGVTaG93KGl0ZW0uZWRpdC53cmFwLCBpdGVtLmRpc3BsYXkud3JhcCk7XG5cdFx0XHR9XG5cdFx0XHRkYXRhLmFjdGlvbnMuZmFkZVRvKDIwMCwgMSk7XG5cdFx0XHRkYXRhLnVsLmZhZGVUbygyMDAsIDEpO1xuXHRcdFx0cmV0dXJuIGFwaS5mYWRlT3V0SW4oZGF0YS5zZXR0aW5ncywgZGF0YS5kb2MpO1xuXHRcdH0sXG5cblx0XHRjbGVhckVycm9yKCkge1xuXHRcdFx0cmV0dXJuIGRhdGEuc2x1cnBFcnJvci5odG1sKCcnKS5oaWRlKCk7XG5cdFx0fSxcblxuXHRcdGVycm9yKG1zZykge1xuXHRcdFx0cmV0dXJuIGRhdGEuc2x1cnBFcnJvci5odG1sKGA8cD4ke21zZ308L3A+YCkuZmFkZUluKDE1MCk7XG5cdFx0fSxcblx0fTtcblxuXHR2YXIgZGF0YSA9IHtcblx0XHRtZW51KCkge1xuXHRcdFx0cmV0dXJuICQoJyNhZG1pbm1lbnUgYS5jdXJyZW50Jyk7XG5cdFx0fSxcblx0XHRoMjoge1xuXHRcdFx0ZWRpdDoge1xuXHRcdFx0XHRpbnB1dDogYXBpLnAoJ2gyLWxhYmVsJyksXG5cdFx0XHRcdHdyYXA6IGFwaS5wKCdoMi1sYWJlbC13cmFwJyksXG5cdFx0XHR9LFxuXHRcdFx0ZGlzcGxheToge1xuXHRcdFx0XHR0ZXh0OiAkKCcud3JhcCBoMTpmaXJzdCcpLFxuXHRcdFx0XHR3cmFwOiAkKCcud3JhcCBoMTpmaXJzdCcpLFxuXHRcdFx0fSxcblx0XHR9LFxuXHRcdGgzOiB7XG5cdFx0XHRlZGl0OiB7XG5cdFx0XHRcdGlucHV0OiBhcGkucCgnbGlzdGluZy1sYWJlbCcpLFxuXHRcdFx0XHR3cmFwOiBhcGkucCgnbGlzdGluZy1sYWJlbHMnKSxcblx0XHRcdH0sXG5cdFx0XHRkaXNwbGF5OiB7XG5cdFx0XHRcdHRleHQ6IGFwaS5wKCdsaXN0aW5nIGgzJyksXG5cdFx0XHRcdHdyYXA6IGFwaS5wKCdsaXN0aW5nIGgzJyksXG5cdFx0XHR9LFxuXHRcdH0sXG5cdFx0c2V0dGluZ3NCdXR0b246IGFwaS5wKCdzZXR0aW5ncy1vbicpLFxuXHRcdGRvYzogYXBpLnAoJ2RvY3VtZW50JyksXG5cdFx0dWw6IGFwaS5wKCdsaXN0aW5nLXdyYXAgPiB1bCcpLFxuXHRcdHVsU29ydGFibGU6IGFwaS5wKCdsaXN0aW5nLXdyYXAgPiB1bC5jYW4tc29ydCcpLFxuXHRcdGFjdGlvbnM6IGFwaS5wKCdhY3Rpb25zJyksXG5cdFx0c2V0dGluZ3M6IGFwaS5wKCdzZXR0aW5ncycpLFxuXHRcdGxpc3Rpbmc6IGFwaS5wKCdsaXN0aW5nJyksXG5cdFx0YXBpVVJMOiBhcGkucCgnYXBpLXVybCcpLFxuXHRcdHNsdXJwOiBhcGkucCgnc2x1cnAtdXJsJyksXG5cdFx0c2x1cnBFcnJvcjogYXBpLnAoJ3NsdXJwLWVycm9yJyksXG5cdFx0c2F2ZUJ1dHRvbjogYXBpLnAoJ3NldHRpbmdzLXNhdmUnKSxcblx0XHRjYW5jZWxMaW5rOiBhcGkucCgnc2V0dGluZ3MtY2FuY2VsJyksXG5cdFx0bWVudUxvY2F0aW9uOiBhcGkucCgnbWVudS1sb2NhdGlvbicpLFxuXHRcdGxvYWRpbmc6IGFwaS5wKCdsb2FkaW5nJyksXG5cdFx0cmV0dXJuTW9uaXRvcjogJCgnLndyYXAgaW5wdXRbdHlwZT1cInRleHRcIl0nKSxcblx0fTtcblxuXHQvLyBCb290c3RyYXAgZXZlcnl0aGluZ1xuXHRyZXR1cm4gYXBpLmluaXQoKTtcbn0pO1xuIl19
