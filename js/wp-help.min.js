(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

/*
 * decaffeinate suggestions:
 * DS102: Remove unnecessary code created because of implicit returns
 * DS207: Consider shorter variations of null checks
 * Full docs: https://github.com/decaffeinate/decaffeinate/blob/master/docs/suggestions.md
 */
jQuery(function ($) {
	var whens = [];
	var deferred = void 0;
	var load = {
		start: function start() {
			var sensitivity = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;

			// Create the timer deferred: the read/write timer state.
			var timer = $.Deferred();

			// Show the spinner.
			data.loading.show();

			// Start the timer.
			setTimeout(function () {
				return timer.resolve();
			}, sensitivity);

			// Return the promise: the read-only timer state.
			return timer.promise();
		},
		stop: function stop() {
			deferred && deferred.reject();

			deferred = null;
			whens = [];
			data.loading.hide();
		},


		/**
   * Show the loading spinner until all the promises succeed.
   * Optionally show the spinner for a minimum amount of time.
  	 * until( [sensitivity], promises* );
   * @param  {number} sensitivity The number of milliseconds to show the spinner, at minimum.
   * @param  {object} promises*   Any number of jQuery promises.
   * @return {object}             A jQuery promise representing the state of all input promises.
  */
		until: function until() {
			var sensitivity = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;

			deferred = deferred || $.Deferred().always(api.load.stop);
			var index = whens.push(false) - 1;

			// Add the start promise onto the the stack.

			for (var _len = arguments.length, promises = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
				promises[_key - 1] = arguments[_key];
			}

			promises.push(api.load.start(sensitivity));

			// When all the promises are complete (including the timer), hide the timer.
			// $.when returns a promise object.
			$.when.apply($, promises).always(function () {
				whens[index] = true;

				// Are there any pending requests?
				if (-1 === $.inArray(false, whens)) {
					return deferred.resolve();
				}
			});

			return deferred.promise();
		}
	};

	var api = {
		p: function p(selectorSuffix) {
			return $('#cws-wp-help-' + selectorSuffix);
		},


		load: load,
		bindH2Updates: function bindH2Updates() {
			// Refresh this in case we just moved the menu
			data.menu().text(data.h2.edit.input.val());

			// Send h2 updates to the menu item as we type
			data.h2.edit.input.bind('keyup', function () {
				data.menu().text($(this).val());
			});
		},
		sortable: function sortable() {
			$(this).sortable({
				opacity: 0.8,
				placeholder: 'cws-wp-help-placeholder',
				axis: 'y',
				cursor: 'move',
				cursorAt: {
					left: 0,
					top: 0
				},

				distance: 10,
				delay: 50,
				handle: '.sort-handle',
				items: '> li.cws-wp-help-local, > div#cws-wp-help-remote-docs-block',
				start: function start(e, ui) {
					var item = $(ui.item);
					var placeholder = $('.cws-wp-help-placeholder');
					var offset = undefined;
					if (item.attr('id') === 'cws-wp-help-remote-docs-block') {
						offset = 4;
					} else {
						offset = -2;
					}
					placeholder.height(item.height() + offset);
				},
				update: function update(e, ui) {
					var request = $.post(ajaxurl, {
						action: 'cws_wp_help_reorder',
						_ajax_nonce: data.ul.data('nonce'),
						order: $(this).sortable('toArray')
					});
					api.load.until(200, request);
				}
			});

			$(this).find('> li:not(.cws-wp-help-is-slurped) > ul > li:nth-child(2)').parent('ul').each(api.sortable);
		},
		sortableInit: function sortableInit() {
			// Wrap remote docs
			data.ul.find('> #cws-wp-help-remote-docs-block > li').unwrap();
			data.ul.find('> li.cws-wp-help-is-slurped:first').before('<div id="cws-wp-help-remote-docs-block"></div>');
			data.ul.find('> li.cws-wp-help-is-slurped').detach().appendTo('#cws-wp-help-remote-docs-block');

			// Sortable
			data.ulSortable.each(api.sortable);
		},
		init: function init() {
			// Sortable.
			api.sortableInit();

			// Add IDs to the list.
			data.ul.find('li.page_item').each(function () {
				var $this = $(this);
				$this.attr('id', 'page-' + $this.attr('class').match(/page-item-([0-9]+)/)[1]);
			});

			// Clicking the source API URI.
			data.apiURL.click(function () {
				this.select();
			});

			// Clicking the "Save Changes" button.
			data.saveButton.click(api.saveSettings);

			// Clicking the "Cancel" button (settings).
			data.cancelLink.click(function (e) {
				e.preventDefault();
				api.restoreSettings();
				api.hideSettings();
			});

			// Clicking the "Settings" button.
			data.settingsButton.click(function (e) {
				e.preventDefault();
				api.revealSettings(true);
			});

			// Doubleclicking the h2.
			data.h2.display.text.dblclick(function () {
				api.revealSettings();
				data.h2.edit.input.focus().select();
			});

			// Doubleclicking the h3.
			data.h3.display.text.dblclick(function () {
				api.revealSettings();
				data.h3.edit.input.focus().select();
			});

			// Monitor for "return" presses in our text inputs.
			data.returnMonitor.bind('keydown', function (e) {
				if (13 === e.which) {
					$(this).blur();
					api.saveSettings();
				}
			});

			api.bindH2Updates();

			// Preview menu placement "live".
			data.menuLocation.change(function () {
				var newLocation = String(window.location);
				if (data.menuLocation.val().indexOf('submenu') === -1) {
					newLocation = newLocation.replace('/index.php', '/admin.php');
				} else {
					newLocation = newLocation.replace('/admin.php', '/index.php');
				}
				var newLocationPreview = String(newLocation) + '&wp-help-preview-menu-location=' + data.menuLocation.val();
				var commonScript = String(newLocation).replace(/\/wp-admin\/.*$/, '/wp-admin/js/common.js');
				$('#adminmenu').load(newLocationPreview + ' #adminmenu', function () {
					window.history.replaceState && window.history.replaceState(null, null, newLocation);
					$.getScript(commonScript); // Makes the menu work again.
					api.bindH2Updates(); // Makes live H2 previewing work again.
				});
			});
		},
		fadeOutIn: function fadeOutIn(first, second) {
			first.fadeOut(150, function () {
				return second.fadeIn(150);
			});
		},
		hideShow: function hideShow(hide, show) {
			hide.hide();
			show.show();
		},
		revealSettings: function revealSettings(autofocus) {
			[data.h2, data.h3].forEach(function (item) {
				return api.hideShow(item.display.wrap, item.edit.wrap);
			});
			data.actions.fadeTo(200, 0.3);
			data.ul.fadeTo(200, 0.3);
			api.fadeOutIn(data.doc, data.settings);
			autofocus && data.h2.edit.input.focus().select();
		},
		restoreSettings: function restoreSettings() {
			$('input, select', data.settings).each(function () {
				var $this = $(this);
				$this.data('original-value') && $this.val($this.data('original-value')).change();
			});
		},
		saveSettings: function saveSettings() {
			api.clearError();
			[data.h2, data.h3].forEach(function (item) {
				return item.display.text.text(item.edit.input.val());
			});

			var request = $.post(ajaxurl, {
				action: 'cws_wp_help_settings',
				_ajax_nonce: $('#_cws_wp_help_nonce').val(),
				h2: data.h2.edit.input.val(),
				h3: data.h3.edit.input.val(),
				menu_location: data.menuLocation.val(),
				slurp_url: data.slurp.val()
			});

			request.success(function (result) {
				result = $.parseJSON(result);
				data.slurp.val(result.slurp_url);

				if (result.error) {
					api.error(result.error);
					data.slurp.focus();
				} else {
					api.hideSettings();
				}

				if (result.topics) {
					api.p('nodocs').remove();
					data.ul.html(result.topics);
					api.sortableInit();
				}
			});

			return api.load.until(200, request);
		},
		hideSettings: function hideSettings() {
			[data.h2, data.h3].forEach(function (item) {
				return api.hideShow(item.edit.wrap, item.display.wrap);
			});
			[data.actions, data.ul].forEach(function (item) {
				return item.fadeTo(200, 1);
			});
			api.fadeOutIn(data.settings, data.doc);
		},
		clearError: function clearError() {
			data.slurpError.html('').hide();
		},
		error: function error(msg) {
			data.slurpError.html('<p>' + msg + '</p>').fadeIn(150);
		}
	};

	var data = {
		menu: function menu() {
			// Dynamic because of our live menu preview.
			return $('#adminmenu a.current .wp-menu-name');
		},

		h2: {
			edit: { input: api.p('h2-label'), wrap: api.p('h2-label-wrap') },
			display: { text: $('.wrap h1:first'), wrap: $('.wrap h1:first') }
		},
		h3: {
			edit: { input: api.p('listing-label'), wrap: api.p('listing-labels') },
			display: { text: api.p('listing h3'), wrap: api.p('listing h3') }
		},
		settingsButton: api.p('settings-on'),
		doc: api.p('document'),
		ul: api.p('listing-wrap > ul'),
		ulSortable: api.p('listing-wrap > ul.can-sort'),
		actions: api.p('actions'),
		settings: api.p('settings'),
		listing: api.p('listing'),
		apiURL: api.p('api-url'),
		slurp: api.p('slurp-url'),
		slurpError: api.p('slurp-error'),
		saveButton: api.p('settings-save'),
		cancelLink: api.p('settings-cancel'),
		menuLocation: api.p('menu-location'),
		loading: api.p('loading'),
		returnMonitor: $('.wrap input[type="text"]')
	};

	// Bootstrap everything.
	return api.init();
});

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy93cC1oZWxwLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUE7Ozs7OztBQU1BLE9BQU8sYUFBSztBQUNYLEtBQUksUUFBUSxFQUFaO0FBQ0EsS0FBSSxpQkFBSjtBQUNBLEtBQUksT0FBTztBQUNWLE9BRFUsbUJBQ2E7QUFBQSxPQUFqQixXQUFpQix1RUFBSCxDQUFHOztBQUN0QjtBQUNBLE9BQU0sUUFBUSxFQUFFLFFBQUYsRUFBZDs7QUFFQTtBQUNBLFFBQUssT0FBTCxDQUFhLElBQWI7O0FBRUE7QUFDQSxjQUFXO0FBQUEsV0FBTSxNQUFNLE9BQU4sRUFBTjtBQUFBLElBQVgsRUFBa0MsV0FBbEM7O0FBRUE7QUFDQSxVQUFPLE1BQU0sT0FBTixFQUFQO0FBQ0EsR0FiUztBQWVWLE1BZlUsa0JBZUg7QUFDTixlQUFZLFNBQVMsTUFBVCxFQUFaOztBQUVBLGNBQVcsSUFBWDtBQUNBLFdBQVEsRUFBUjtBQUNBLFFBQUssT0FBTCxDQUFhLElBQWI7QUFDQSxHQXJCUzs7O0FBdUJWOzs7Ozs7OztBQVNBLE9BaENVLG1CQWdDMEI7QUFBQSxPQUE5QixXQUE4Qix1RUFBaEIsQ0FBZ0I7O0FBQ25DLGNBQVcsWUFBWSxFQUFFLFFBQUYsR0FBYSxNQUFiLENBQW9CLElBQUksSUFBSixDQUFTLElBQTdCLENBQXZCO0FBQ0EsT0FBTSxRQUFRLE1BQU0sSUFBTixDQUFXLEtBQVgsSUFBb0IsQ0FBbEM7O0FBRUE7O0FBSm1DLHFDQUFWLFFBQVU7QUFBVixZQUFVO0FBQUE7O0FBS25DLFlBQVMsSUFBVCxDQUFjLElBQUksSUFBSixDQUFTLEtBQVQsQ0FBZSxXQUFmLENBQWQ7O0FBRUE7QUFDQTtBQUNBLEtBQUUsSUFBRixDQUFPLEtBQVAsQ0FBYSxDQUFiLEVBQWdCLFFBQWhCLEVBQTBCLE1BQTFCLENBQWlDLFlBQVc7QUFDM0MsVUFBTSxLQUFOLElBQWUsSUFBZjs7QUFF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QU0sVUFBTixDQWxCRTtBQW1CWixXQUFTLElBQUksQ0FBSixDQUFNLFNBQU4sQ0FuQkc7QUFvQlosVUFBUSxJQUFJLENBQUosQ0FBTSxTQUFOLENBcEJJO0FBcUJaLFNBQU8sSUFBSSxDQUFKLENBQU0sV0FBTixDQXJCSztBQXNCWixjQUFZLElBQUksQ0FBSixDQUFNLGFBQU4sQ0F0QkE7QUF1QlosY0FBWSxJQUFJLENBQUosQ0FBTSxlQUFOLENBdkJBO0FBd0JaLGNBQVksSUFBSSxDQUFKLENBQU0saUJBQU4sQ0F4QkE7QUF5QlosZ0JBQWMsSUFBSSxDQUFKLENBQU0sZUFBTixDQXpCRjtBQTBCWixXQUFTLElBQUksQ0FBSixDQUFNLFNBQU4sQ0ExQkc7QUEyQlosaUJBQWUsRUFBRSwwQkFBRjtBQTNCSCxFQUFiOztBQThCQTtBQUNBLFFBQU8sSUFBSSxJQUFKLEVBQVA7QUFDQSxDQW5VRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8qXG4gKiBkZWNhZmZlaW5hdGUgc3VnZ2VzdGlvbnM6XG4gKiBEUzEwMjogUmVtb3ZlIHVubmVjZXNzYXJ5IGNvZGUgY3JlYXRlZCBiZWNhdXNlIG9mIGltcGxpY2l0IHJldHVybnNcbiAqIERTMjA3OiBDb25zaWRlciBzaG9ydGVyIHZhcmlhdGlvbnMgb2YgbnVsbCBjaGVja3NcbiAqIEZ1bGwgZG9jczogaHR0cHM6Ly9naXRodWIuY29tL2RlY2FmZmVpbmF0ZS9kZWNhZmZlaW5hdGUvYmxvYi9tYXN0ZXIvZG9jcy9zdWdnZXN0aW9ucy5tZFxuICovXG5qUXVlcnkoJCA9PiB7XG5cdGxldCB3aGVucyA9IFtdO1xuXHRsZXQgZGVmZXJyZWQ7XG5cdGxldCBsb2FkID0ge1xuXHRcdHN0YXJ0KHNlbnNpdGl2aXR5ID0gMCkge1xuXHRcdFx0Ly8gQ3JlYXRlIHRoZSB0aW1lciBkZWZlcnJlZDogdGhlIHJlYWQvd3JpdGUgdGltZXIgc3RhdGUuXG5cdFx0XHRjb25zdCB0aW1lciA9ICQuRGVmZXJyZWQoKTtcblxuXHRcdFx0Ly8gU2hvdyB0aGUgc3Bpbm5lci5cblx0XHRcdGRhdGEubG9hZGluZy5zaG93KCk7XG5cblx0XHRcdC8vIFN0YXJ0IHRoZSB0aW1lci5cblx0XHRcdHNldFRpbWVvdXQoKCkgPT4gdGltZXIucmVzb2x2ZSgpLCBzZW5zaXRpdml0eSk7XG5cblx0XHRcdC8vIFJldHVybiB0aGUgcHJvbWlzZTogdGhlIHJlYWQtb25seSB0aW1lciBzdGF0ZS5cblx0XHRcdHJldHVybiB0aW1lci5wcm9taXNlKCk7XG5cdFx0fSxcblxuXHRcdHN0b3AoKSB7XG5cdFx0XHRkZWZlcnJlZCAmJiBkZWZlcnJlZC5yZWplY3QoKTtcblxuXHRcdFx0ZGVmZXJyZWQgPSBudWxsO1xuXHRcdFx0d2hlbnMgPSBbXTtcblx0XHRcdGRhdGEubG9hZGluZy5oaWRlKCk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIFNob3cgdGhlIGxvYWRpbmcgc3Bpbm5lciB1bnRpbCBhbGwgdGhlIHByb21pc2VzIHN1Y2NlZWQuXG5cdFx0ICogT3B0aW9uYWxseSBzaG93IHRoZSBzcGlubmVyIGZvciBhIG1pbmltdW0gYW1vdW50IG9mIHRpbWUuXG5cblx0XHQgKiB1bnRpbCggW3NlbnNpdGl2aXR5XSwgcHJvbWlzZXMqICk7XG5cdFx0ICogQHBhcmFtICB7bnVtYmVyfSBzZW5zaXRpdml0eSBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byBzaG93IHRoZSBzcGlubmVyLCBhdCBtaW5pbXVtLlxuXHRcdCAqIEBwYXJhbSAge29iamVjdH0gcHJvbWlzZXMqICAgQW55IG51bWJlciBvZiBqUXVlcnkgcHJvbWlzZXMuXG5cdFx0ICogQHJldHVybiB7b2JqZWN0fSAgICAgICAgICAgICBBIGpRdWVyeSBwcm9taXNlIHJlcHJlc2VudGluZyB0aGUgc3RhdGUgb2YgYWxsIGlucHV0IHByb21pc2VzLlxuXHRcdCovXG5cdFx0dW50aWwoc2Vuc2l0aXZpdHkgPSAwLCAuLi5wcm9taXNlcykge1xuXHRcdFx0ZGVmZXJyZWQgPSBkZWZlcnJlZCB8fCAkLkRlZmVycmVkKCkuYWx3YXlzKGFwaS5sb2FkLnN0b3ApO1xuXHRcdFx0Y29uc3QgaW5kZXggPSB3aGVucy5wdXNoKGZhbHNlKSAtIDE7XG5cblx0XHRcdC8vIEFkZCB0aGUgc3RhcnQgcHJvbWlzZSBvbnRvIHRoZSB0aGUgc3RhY2suXG5cdFx0XHRwcm9taXNlcy5wdXNoKGFwaS5sb2FkLnN0YXJ0KHNlbnNpdGl2aXR5KSk7XG5cblx0XHRcdC8vIFdoZW4gYWxsIHRoZSBwcm9taXNlcyBhcmUgY29tcGxldGUgKGluY2x1ZGluZyB0aGUgdGltZXIpLCBoaWRlIHRoZSB0aW1lci5cblx0XHRcdC8vICQud2hlbiByZXR1cm5zIGEgcHJvbWlzZSBvYmplY3QuXG5cdFx0XHQkLndoZW4uYXBwbHkoJCwgcHJvbWlzZXMpLmFsd2F5cyhmdW5jdGlvbigpIHtcblx0XHRcdFx0d2hlbnNbaW5kZXhdID0gdHJ1ZTtcblxuXHRcdFx0XHQvLyBBcmUgdGhlcmUgYW55IHBlbmRpbmcgcmVxdWVzdHM/XG5cdFx0XHRcdGlmICgtMSA9PT0gJC5pbkFycmF5KGZhbHNlLCB3aGVucykpIHtcblx0XHRcdFx0XHRyZXR1cm4gZGVmZXJyZWQucmVzb2x2ZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0cmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcblx0XHR9LFxuXHR9O1xuXG5cdGNvbnN0IGFwaSA9IHtcblx0XHRwKHNlbGVjdG9yU3VmZml4KSB7XG5cdFx0XHRyZXR1cm4gJChgI2N3cy13cC1oZWxwLSR7c2VsZWN0b3JTdWZmaXh9YCk7XG5cdFx0fSxcblxuXHRcdGxvYWQ6IGxvYWQsXG5cdFx0YmluZEgyVXBkYXRlcygpIHtcblx0XHRcdC8vIFJlZnJlc2ggdGhpcyBpbiBjYXNlIHdlIGp1c3QgbW92ZWQgdGhlIG1lbnVcblx0XHRcdGRhdGEubWVudSgpLnRleHQoZGF0YS5oMi5lZGl0LmlucHV0LnZhbCgpKTtcblxuXHRcdFx0Ly8gU2VuZCBoMiB1cGRhdGVzIHRvIHRoZSBtZW51IGl0ZW0gYXMgd2UgdHlwZVxuXHRcdFx0ZGF0YS5oMi5lZGl0LmlucHV0LmJpbmQoJ2tleXVwJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGRhdGEubWVudSgpLnRleHQoJCh0aGlzKS52YWwoKSk7XG5cdFx0XHR9KTtcblx0XHR9LFxuXG5cdFx0c29ydGFibGUoKSB7XG5cdFx0XHQkKHRoaXMpLnNvcnRhYmxlKHtcblx0XHRcdFx0b3BhY2l0eTogMC44LFxuXHRcdFx0XHRwbGFjZWhvbGRlcjogJ2N3cy13cC1oZWxwLXBsYWNlaG9sZGVyJyxcblx0XHRcdFx0YXhpczogJ3knLFxuXHRcdFx0XHRjdXJzb3I6ICdtb3ZlJyxcblx0XHRcdFx0Y3Vyc29yQXQ6IHtcblx0XHRcdFx0XHRsZWZ0OiAwLFxuXHRcdFx0XHRcdHRvcDogMCxcblx0XHRcdFx0fSxcblxuXHRcdFx0XHRkaXN0YW5jZTogMTAsXG5cdFx0XHRcdGRlbGF5OiA1MCxcblx0XHRcdFx0aGFuZGxlOiAnLnNvcnQtaGFuZGxlJyxcblx0XHRcdFx0aXRlbXM6ICc+IGxpLmN3cy13cC1oZWxwLWxvY2FsLCA+IGRpdiNjd3Mtd3AtaGVscC1yZW1vdGUtZG9jcy1ibG9jaycsXG5cdFx0XHRcdHN0YXJ0KGUsIHVpKSB7XG5cdFx0XHRcdFx0Y29uc3QgaXRlbSA9ICQodWkuaXRlbSk7XG5cdFx0XHRcdFx0Y29uc3QgcGxhY2Vob2xkZXIgPSAkKCcuY3dzLXdwLWhlbHAtcGxhY2Vob2xkZXInKTtcblx0XHRcdFx0XHRsZXQgb2Zmc2V0ID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdGlmIChpdGVtLmF0dHIoJ2lkJykgPT09ICdjd3Mtd3AtaGVscC1yZW1vdGUtZG9jcy1ibG9jaycpIHtcblx0XHRcdFx0XHRcdG9mZnNldCA9IDQ7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdG9mZnNldCA9IC0yO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRwbGFjZWhvbGRlci5oZWlnaHQoaXRlbS5oZWlnaHQoKSArIG9mZnNldCk7XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0dXBkYXRlKGUsIHVpKSB7XG5cdFx0XHRcdFx0Y29uc3QgcmVxdWVzdCA9ICQucG9zdChhamF4dXJsLCB7XG5cdFx0XHRcdFx0XHRhY3Rpb246ICdjd3Nfd3BfaGVscF9yZW9yZGVyJyxcblx0XHRcdFx0XHRcdF9hamF4X25vbmNlOiBkYXRhLnVsLmRhdGEoJ25vbmNlJyksXG5cdFx0XHRcdFx0XHRvcmRlcjogJCh0aGlzKS5zb3J0YWJsZSgndG9BcnJheScpLFxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdGFwaS5sb2FkLnVudGlsKDIwMCwgcmVxdWVzdCk7XG5cdFx0XHRcdH0sXG5cdFx0XHR9KTtcblxuXHRcdFx0JCh0aGlzKVxuXHRcdFx0XHQuZmluZCgnPiBsaTpub3QoLmN3cy13cC1oZWxwLWlzLXNsdXJwZWQpID4gdWwgPiBsaTpudGgtY2hpbGQoMiknKVxuXHRcdFx0XHQucGFyZW50KCd1bCcpXG5cdFx0XHRcdC5lYWNoKGFwaS5zb3J0YWJsZSk7XG5cdFx0fSxcblxuXHRcdHNvcnRhYmxlSW5pdCgpIHtcblx0XHRcdC8vIFdyYXAgcmVtb3RlIGRvY3Ncblx0XHRcdGRhdGEudWwuZmluZCgnPiAjY3dzLXdwLWhlbHAtcmVtb3RlLWRvY3MtYmxvY2sgPiBsaScpLnVud3JhcCgpO1xuXHRcdFx0ZGF0YS51bFxuXHRcdFx0XHQuZmluZCgnPiBsaS5jd3Mtd3AtaGVscC1pcy1zbHVycGVkOmZpcnN0Jylcblx0XHRcdFx0LmJlZm9yZSgnPGRpdiBpZD1cImN3cy13cC1oZWxwLXJlbW90ZS1kb2NzLWJsb2NrXCI+PC9kaXY+Jyk7XG5cdFx0XHRkYXRhLnVsXG5cdFx0XHRcdC5maW5kKCc+IGxpLmN3cy13cC1oZWxwLWlzLXNsdXJwZWQnKVxuXHRcdFx0XHQuZGV0YWNoKClcblx0XHRcdFx0LmFwcGVuZFRvKCcjY3dzLXdwLWhlbHAtcmVtb3RlLWRvY3MtYmxvY2snKTtcblxuXHRcdFx0Ly8gU29ydGFibGVcblx0XHRcdGRhdGEudWxTb3J0YWJsZS5lYWNoKGFwaS5zb3J0YWJsZSk7XG5cdFx0fSxcblxuXHRcdGluaXQoKSB7XG5cdFx0XHQvLyBTb3J0YWJsZS5cblx0XHRcdGFwaS5zb3J0YWJsZUluaXQoKTtcblxuXHRcdFx0Ly8gQWRkIElEcyB0byB0aGUgbGlzdC5cblx0XHRcdGRhdGEudWwuZmluZCgnbGkucGFnZV9pdGVtJykuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0Y29uc3QgJHRoaXMgPSAkKHRoaXMpO1xuXHRcdFx0XHQkdGhpcy5hdHRyKFxuXHRcdFx0XHRcdCdpZCcsXG5cdFx0XHRcdFx0YHBhZ2UtJHskdGhpcy5hdHRyKCdjbGFzcycpLm1hdGNoKC9wYWdlLWl0ZW0tKFswLTldKykvKVsxXX1gXG5cdFx0XHRcdCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gQ2xpY2tpbmcgdGhlIHNvdXJjZSBBUEkgVVJJLlxuXHRcdFx0ZGF0YS5hcGlVUkwuY2xpY2soZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuc2VsZWN0KCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gQ2xpY2tpbmcgdGhlIFwiU2F2ZSBDaGFuZ2VzXCIgYnV0dG9uLlxuXHRcdFx0ZGF0YS5zYXZlQnV0dG9uLmNsaWNrKGFwaS5zYXZlU2V0dGluZ3MpO1xuXG5cdFx0XHQvLyBDbGlja2luZyB0aGUgXCJDYW5jZWxcIiBidXR0b24gKHNldHRpbmdzKS5cblx0XHRcdGRhdGEuY2FuY2VsTGluay5jbGljayhmdW5jdGlvbihlKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0YXBpLnJlc3RvcmVTZXR0aW5ncygpO1xuXHRcdFx0XHRhcGkuaGlkZVNldHRpbmdzKCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gQ2xpY2tpbmcgdGhlIFwiU2V0dGluZ3NcIiBidXR0b24uXG5cdFx0XHRkYXRhLnNldHRpbmdzQnV0dG9uLmNsaWNrKGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRhcGkucmV2ZWFsU2V0dGluZ3ModHJ1ZSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gRG91YmxlY2xpY2tpbmcgdGhlIGgyLlxuXHRcdFx0ZGF0YS5oMi5kaXNwbGF5LnRleHQuZGJsY2xpY2soZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGFwaS5yZXZlYWxTZXR0aW5ncygpO1xuXHRcdFx0XHRkYXRhLmgyLmVkaXQuaW5wdXQuZm9jdXMoKS5zZWxlY3QoKTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBEb3VibGVjbGlja2luZyB0aGUgaDMuXG5cdFx0XHRkYXRhLmgzLmRpc3BsYXkudGV4dC5kYmxjbGljayhmdW5jdGlvbigpIHtcblx0XHRcdFx0YXBpLnJldmVhbFNldHRpbmdzKCk7XG5cdFx0XHRcdGRhdGEuaDMuZWRpdC5pbnB1dC5mb2N1cygpLnNlbGVjdCgpO1xuXHRcdFx0fSk7XG5cblx0XHRcdC8vIE1vbml0b3IgZm9yIFwicmV0dXJuXCIgcHJlc3NlcyBpbiBvdXIgdGV4dCBpbnB1dHMuXG5cdFx0XHRkYXRhLnJldHVybk1vbml0b3IuYmluZCgna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0aWYgKDEzID09PSBlLndoaWNoKSB7XG5cdFx0XHRcdFx0JCh0aGlzKS5ibHVyKCk7XG5cdFx0XHRcdFx0YXBpLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0YXBpLmJpbmRIMlVwZGF0ZXMoKTtcblxuXHRcdFx0Ly8gUHJldmlldyBtZW51IHBsYWNlbWVudCBcImxpdmVcIi5cblx0XHRcdGRhdGEubWVudUxvY2F0aW9uLmNoYW5nZShmdW5jdGlvbigpIHtcblx0XHRcdFx0bGV0IG5ld0xvY2F0aW9uID0gU3RyaW5nKHdpbmRvdy5sb2NhdGlvbik7XG5cdFx0XHRcdGlmIChkYXRhLm1lbnVMb2NhdGlvbi52YWwoKS5pbmRleE9mKCdzdWJtZW51JykgPT09IC0xKSB7XG5cdFx0XHRcdFx0bmV3TG9jYXRpb24gPSBuZXdMb2NhdGlvbi5yZXBsYWNlKCcvaW5kZXgucGhwJywgJy9hZG1pbi5waHAnKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRuZXdMb2NhdGlvbiA9IG5ld0xvY2F0aW9uLnJlcGxhY2UoJy9hZG1pbi5waHAnLCAnL2luZGV4LnBocCcpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGNvbnN0IG5ld0xvY2F0aW9uUHJldmlldyA9IGAke1N0cmluZyhcblx0XHRcdFx0XHRuZXdMb2NhdGlvblxuXHRcdFx0XHQpfSZ3cC1oZWxwLXByZXZpZXctbWVudS1sb2NhdGlvbj0ke2RhdGEubWVudUxvY2F0aW9uLnZhbCgpfWA7XG5cdFx0XHRcdGNvbnN0IGNvbW1vblNjcmlwdCA9IFN0cmluZyhuZXdMb2NhdGlvbikucmVwbGFjZShcblx0XHRcdFx0XHQvXFwvd3AtYWRtaW5cXC8uKiQvLFxuXHRcdFx0XHRcdCcvd3AtYWRtaW4vanMvY29tbW9uLmpzJ1xuXHRcdFx0XHQpO1xuXHRcdFx0XHQkKCcjYWRtaW5tZW51JykubG9hZChuZXdMb2NhdGlvblByZXZpZXcgKyAnICNhZG1pbm1lbnUnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR3aW5kb3cuaGlzdG9yeS5yZXBsYWNlU3RhdGUgJiZcblx0XHRcdFx0XHRcdHdpbmRvdy5oaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCBudWxsLCBuZXdMb2NhdGlvbik7XG5cdFx0XHRcdFx0JC5nZXRTY3JpcHQoY29tbW9uU2NyaXB0KTsgLy8gTWFrZXMgdGhlIG1lbnUgd29yayBhZ2Fpbi5cblx0XHRcdFx0XHRhcGkuYmluZEgyVXBkYXRlcygpOyAvLyBNYWtlcyBsaXZlIEgyIHByZXZpZXdpbmcgd29yayBhZ2Fpbi5cblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9LFxuXG5cdFx0ZmFkZU91dEluKGZpcnN0LCBzZWNvbmQpIHtcblx0XHRcdGZpcnN0LmZhZGVPdXQoMTUwLCAoKSA9PiBzZWNvbmQuZmFkZUluKDE1MCkpO1xuXHRcdH0sXG5cblx0XHRoaWRlU2hvdyhoaWRlLCBzaG93KSB7XG5cdFx0XHRoaWRlLmhpZGUoKTtcblx0XHRcdHNob3cuc2hvdygpO1xuXHRcdH0sXG5cblx0XHRyZXZlYWxTZXR0aW5ncyhhdXRvZm9jdXMpIHtcblx0XHRcdFtkYXRhLmgyLCBkYXRhLmgzXS5mb3JFYWNoKGl0ZW0gPT5cblx0XHRcdFx0YXBpLmhpZGVTaG93KGl0ZW0uZGlzcGxheS53cmFwLCBpdGVtLmVkaXQud3JhcClcblx0XHRcdCk7XG5cdFx0XHRkYXRhLmFjdGlvbnMuZmFkZVRvKDIwMCwgMC4zKTtcblx0XHRcdGRhdGEudWwuZmFkZVRvKDIwMCwgMC4zKTtcblx0XHRcdGFwaS5mYWRlT3V0SW4oZGF0YS5kb2MsIGRhdGEuc2V0dGluZ3MpO1xuXHRcdFx0YXV0b2ZvY3VzICYmIGRhdGEuaDIuZWRpdC5pbnB1dC5mb2N1cygpLnNlbGVjdCgpO1xuXHRcdH0sXG5cblx0XHRyZXN0b3JlU2V0dGluZ3MoKSB7XG5cdFx0XHQkKCdpbnB1dCwgc2VsZWN0JywgZGF0YS5zZXR0aW5ncykuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0Y29uc3QgJHRoaXMgPSAkKHRoaXMpO1xuXHRcdFx0XHQkdGhpcy5kYXRhKCdvcmlnaW5hbC12YWx1ZScpICYmXG5cdFx0XHRcdFx0JHRoaXMudmFsKCR0aGlzLmRhdGEoJ29yaWdpbmFsLXZhbHVlJykpLmNoYW5nZSgpO1xuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdHNhdmVTZXR0aW5ncygpIHtcblx0XHRcdGFwaS5jbGVhckVycm9yKCk7XG5cdFx0XHRbZGF0YS5oMiwgZGF0YS5oM10uZm9yRWFjaChpdGVtID0+XG5cdFx0XHRcdGl0ZW0uZGlzcGxheS50ZXh0LnRleHQoaXRlbS5lZGl0LmlucHV0LnZhbCgpKVxuXHRcdFx0KTtcblxuXHRcdFx0Y29uc3QgcmVxdWVzdCA9ICQucG9zdChhamF4dXJsLCB7XG5cdFx0XHRcdGFjdGlvbjogJ2N3c193cF9oZWxwX3NldHRpbmdzJyxcblx0XHRcdFx0X2FqYXhfbm9uY2U6ICQoJyNfY3dzX3dwX2hlbHBfbm9uY2UnKS52YWwoKSxcblx0XHRcdFx0aDI6IGRhdGEuaDIuZWRpdC5pbnB1dC52YWwoKSxcblx0XHRcdFx0aDM6IGRhdGEuaDMuZWRpdC5pbnB1dC52YWwoKSxcblx0XHRcdFx0bWVudV9sb2NhdGlvbjogZGF0YS5tZW51TG9jYXRpb24udmFsKCksXG5cdFx0XHRcdHNsdXJwX3VybDogZGF0YS5zbHVycC52YWwoKSxcblx0XHRcdH0pO1xuXG5cdFx0XHRyZXF1ZXN0LnN1Y2Nlc3MoZnVuY3Rpb24ocmVzdWx0KSB7XG5cdFx0XHRcdHJlc3VsdCA9ICQucGFyc2VKU09OKHJlc3VsdCk7XG5cdFx0XHRcdGRhdGEuc2x1cnAudmFsKHJlc3VsdC5zbHVycF91cmwpO1xuXG5cdFx0XHRcdGlmIChyZXN1bHQuZXJyb3IpIHtcblx0XHRcdFx0XHRhcGkuZXJyb3IocmVzdWx0LmVycm9yKTtcblx0XHRcdFx0XHRkYXRhLnNsdXJwLmZvY3VzKCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0YXBpLmhpZGVTZXR0aW5ncygpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKHJlc3VsdC50b3BpY3MpIHtcblx0XHRcdFx0XHRhcGkucCgnbm9kb2NzJykucmVtb3ZlKCk7XG5cdFx0XHRcdFx0ZGF0YS51bC5odG1sKHJlc3VsdC50b3BpY3MpO1xuXHRcdFx0XHRcdGFwaS5zb3J0YWJsZUluaXQoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHJldHVybiBhcGkubG9hZC51bnRpbCgyMDAsIHJlcXVlc3QpO1xuXHRcdH0sXG5cblx0XHRoaWRlU2V0dGluZ3MoKSB7XG5cdFx0XHRbZGF0YS5oMiwgZGF0YS5oM10uZm9yRWFjaChpdGVtID0+XG5cdFx0XHRcdGFwaS5oaWRlU2hvdyhpdGVtLmVkaXQud3JhcCwgaXRlbS5kaXNwbGF5LndyYXApXG5cdFx0XHQpO1xuXHRcdFx0W2RhdGEuYWN0aW9ucywgZGF0YS51bF0uZm9yRWFjaChpdGVtID0+IGl0ZW0uZmFkZVRvKDIwMCwgMSkpO1xuXHRcdFx0YXBpLmZhZGVPdXRJbihkYXRhLnNldHRpbmdzLCBkYXRhLmRvYyk7XG5cdFx0fSxcblxuXHRcdGNsZWFyRXJyb3IoKSB7XG5cdFx0XHRkYXRhLnNsdXJwRXJyb3IuaHRtbCgnJykuaGlkZSgpO1xuXHRcdH0sXG5cblx0XHRlcnJvcihtc2cpIHtcblx0XHRcdGRhdGEuc2x1cnBFcnJvci5odG1sKGA8cD4ke21zZ308L3A+YCkuZmFkZUluKDE1MCk7XG5cdFx0fSxcblx0fTtcblxuXHRjb25zdCBkYXRhID0ge1xuXHRcdG1lbnUoKSB7XG5cdFx0XHQvLyBEeW5hbWljIGJlY2F1c2Ugb2Ygb3VyIGxpdmUgbWVudSBwcmV2aWV3LlxuXHRcdFx0cmV0dXJuICQoJyNhZG1pbm1lbnUgYS5jdXJyZW50IC53cC1tZW51LW5hbWUnKTtcblx0XHR9LFxuXHRcdGgyOiB7XG5cdFx0XHRlZGl0OiB7IGlucHV0OiBhcGkucCgnaDItbGFiZWwnKSwgd3JhcDogYXBpLnAoJ2gyLWxhYmVsLXdyYXAnKSB9LFxuXHRcdFx0ZGlzcGxheTogeyB0ZXh0OiAkKCcud3JhcCBoMTpmaXJzdCcpLCB3cmFwOiAkKCcud3JhcCBoMTpmaXJzdCcpIH0sXG5cdFx0fSxcblx0XHRoMzoge1xuXHRcdFx0ZWRpdDogeyBpbnB1dDogYXBpLnAoJ2xpc3RpbmctbGFiZWwnKSwgd3JhcDogYXBpLnAoJ2xpc3RpbmctbGFiZWxzJykgfSxcblx0XHRcdGRpc3BsYXk6IHsgdGV4dDogYXBpLnAoJ2xpc3RpbmcgaDMnKSwgd3JhcDogYXBpLnAoJ2xpc3RpbmcgaDMnKSB9LFxuXHRcdH0sXG5cdFx0c2V0dGluZ3NCdXR0b246IGFwaS5wKCdzZXR0aW5ncy1vbicpLFxuXHRcdGRvYzogYXBpLnAoJ2RvY3VtZW50JyksXG5cdFx0dWw6IGFwaS5wKCdsaXN0aW5nLXdyYXAgPiB1bCcpLFxuXHRcdHVsU29ydGFibGU6IGFwaS5wKCdsaXN0aW5nLXdyYXAgPiB1bC5jYW4tc29ydCcpLFxuXHRcdGFjdGlvbnM6IGFwaS5wKCdhY3Rpb25zJyksXG5cdFx0c2V0dGluZ3M6IGFwaS5wKCdzZXR0aW5ncycpLFxuXHRcdGxpc3Rpbmc6IGFwaS5wKCdsaXN0aW5nJyksXG5cdFx0YXBpVVJMOiBhcGkucCgnYXBpLXVybCcpLFxuXHRcdHNsdXJwOiBhcGkucCgnc2x1cnAtdXJsJyksXG5cdFx0c2x1cnBFcnJvcjogYXBpLnAoJ3NsdXJwLWVycm9yJyksXG5cdFx0c2F2ZUJ1dHRvbjogYXBpLnAoJ3NldHRpbmdzLXNhdmUnKSxcblx0XHRjYW5jZWxMaW5rOiBhcGkucCgnc2V0dGluZ3MtY2FuY2VsJyksXG5cdFx0bWVudUxvY2F0aW9uOiBhcGkucCgnbWVudS1sb2NhdGlvbicpLFxuXHRcdGxvYWRpbmc6IGFwaS5wKCdsb2FkaW5nJyksXG5cdFx0cmV0dXJuTW9uaXRvcjogJCgnLndyYXAgaW5wdXRbdHlwZT1cInRleHRcIl0nKSxcblx0fTtcblxuXHQvLyBCb290c3RyYXAgZXZlcnl0aGluZy5cblx0cmV0dXJuIGFwaS5pbml0KCk7XG59KTtcbiJdfQ==
